jaxb2-rich-contract-plugin
==========================

This module is a collection of several plugins for the JAXB2 (Java API for XML binding) "XSD to Java Compiler" (XJC).
The plugins are intended to add support for additional contracts to the classes generated by XJC.
Currently, there are 3 plugin classes:

1. group-interface: When using `<attribute-group>` or `<group>` elements in an XSD, they are transformed as interface definitions, and any complexTypes using the groups will be generated as classes implementing this interface.
2. constrained-properties: Will generate a complexTypes element members as bound and/or constrained properties as per the JavaBeans spec.
3. clone: Will generate a simple deep "clone" method for the generated classes based on the heuristic that it only makes sense to traverse further down in the cloned object tree for members of types that are actually cloenable themselves.

### Usage
#### General
jaxb2-rich-contract-plugin is a plugin to the XJC "XML to Java compiler" shipped with the
reference implementation of JAXB, included in all JDKs since 1.6.
It is targeted on version 2.2 of the JAXB API.
In order to make it work, you must do two things:
* Add the jar file to the classpath of XJC
* Add the corresponding activating command-line option to XJC's invocation,
  see below for details of each of the plugins

#### From Maven
You should add "maven-jaxb21-plugin" or "maven-jaxb22-plugin" to your `<build>`
configuration.
Then add "jaxb2-group-contract":

    <build>
        <plugins>
            <plugin>
                <groupId>org.jvnet.jaxb2.maven2</groupId>
                <artifactId>maven-jaxb21-plugin</artifactId>
                <version>0.8.2</version>
                <executions>
                    <execution>
                        <id>xsd-generate-2.1</id>
                        <phase>generate-sources</phase>
                        <goals>
                            <goal>generate</goal>
                        </goals>
                    </execution>
                </executions>
                <configuration>
                    <schemaIncludes>
                        <schemaInclude>**/*.xsd</schemaInclude>
                    </schemaIncludes>
                    <strict>true</strict>
                    <verbose>true</verbose>
                    <extension>true</extension>
                    <removeOldOutput>true</removeOldOutput>
                    <args>
                        <arg>-Xgroup-contract</arg>
                        <arg>-Xconstrained-properties</arg>
                        <arg>-Xclone</arg>
                        <arg>...</arg>
                    </args>
                    <plugins>
                        <plugin>
                            <groupId>com.kscs.util</groupId>
                            <artifactId>jaxb2-rich-contract-plugin</artifactId>
                            <version>1.0.0</version>
                        </plugin>
                    </plugins>
                </configuration>
            </plugin>
        </plugins>
    </build>

Note: the `<extension>` flag must be set to "true" in order to make XJC accept any extensions at all.


### Version History
1.0.0:		Initial Version



group-interface
--------------------

### Motivation
Out of the box, the only polymorphism supported by classes generated from an XSD is the `<extension>` notion,
transformed directly into an inheritance relationship by XJC.
However, pure inheritance relationships are often inflexible and do not always reflect the intention
of generating a "contract" that implementing classes must follow.

### Function
For definition of contracts, two additional XSD constructs, the `<group>` and `<attributeGroup>`,
are readily available in XSD, but they're currently ignored by standard XJC and simply treated as an inclusion of
elements or attributes into a generated class definition.
The group-interface plugin changes that and generates an `interface` definition for each `group` or `attributeGroup`
found in your model, defines the attributes or elements declared in the groups as get and set methods on the interface,
and makes each generated class using the group or attributeGroup implement this interface.

### Usage
See below on how to add the jaxb2-rich-contract-plugin to your plugin path when building your project with maven.
group-interface is activated by adding the `-Xgroup-contract` command-line option to your XJC invocation.
For group-interface, there are currently no further command line options.

### Limitations
* Currently, interface definitions are only generated if there actually is a
  `complexType` using the respective `group` or `attributeGroup`. This is because, for
  the sake of simplicity, the plugin copies back the method definitions in the
  interfaces from the implementing classes, rather than generating the method
  definitions entirely on its own, taking into account possible other plugins etc.
* There should be an option to limit the contract only to property getter methods, or
  to extend it to the fluent-interface "withXXX"-Methods, when the "fluent-interface"
  plugin is active.

### Bugs
* Currently none known.



constrained-properties
----------------------

### Motivation
Many GUI applications use data binding to connect the data model to the view components. The JavaBeans standard
defines a simple component model that also supports properties which send notifications whenever the are about to be changed,
and there are even vetoable changes that allow a change listener to inhibit modification of a property.
While the JAvaBeans standard is a bit dated, data binding and property change notification can come in handy in many situations,
even for debugging or reverse-engineering existing code, because you can track any change made to the model instance.

### Function
constrained-properties generates additional code in the property setter methods of the POJOs generated by XJC that
allow PropertyChangeListeners and VetoableChangeListeners to be attached to any instance of a XJC-generated class.
Currently, indexed properties ar NOT supported in the way specified by JavaBeans, but instead, if a property represents a collection,
a collection proxy class is generated that supports its own set of collection-specific change notifications, vetoable and other.
This decision has been made because by default XJC generates collection properties rather than indexed properties,
and indexed properties as mandated by JavaBeans are generally considered "out of style".

### Usage
Activate the plugin by giving command-line option `-Xconstrained-properties` to XJC.
Other options supported:
`-setter-throws=`y/n		Generate the setter method with "throws PropertyVetoException" if constrained properties are
							used. If no, only a RuntimeException is thrown on a PropertyVeto event. Default: n
`-constrained=`y/n			Generate constrained properties, where a listener can inhibit the property change. Default: y
`-bound=`y/n				Generate bound properties. Default: y
`-generate-tools=`y/n		To support Collection-specific change events and behavior, additional classes are required.
							If you set this option to "yes", these auxiliary classes will be generated into the source
							code along with the generated JAXB classes. If you set this to "no", you will have to include
							the plugin artifact into the runtime classpath of your application.

### Limitations
* The JavaBeans standard is only loosely implemented in the generated classes.
* Indexed Properties as defined in JavaBeans are not supported.
* The CollectionChange behavior implemented by the classes is not yet documented
  and non-standard.

### Bugs
* Currently none known.

clone
-----

### Motivation
Sometimes it is necessary to create a deep copy of an object. There are various approaches to this. The clone plugin
tries to do it in a simple and reliable way.

### Function
The `clone` plugin generates a deep clone method for each of the generated classes, based on the following assumptions:
* Instances of any other class generated from the same XSD model are cloneable by the same semantics as "this".
* Objects implementing `java.lang.Cloneable` and not throwing "CloneNotSupportedException" are also reliably cloneable
  by their "clone" Method.
* Objects not implementing `java.lang.Cloneable` or primitive types are assumed to be immutable,
  their references are copied over, they are not cloned.

### Usage
Plugin activation: `-Xclone`.
Options:
`-clone-throws=`y/n			Declare "clone"-Method to throw "CloneNotSupportedException" if an object doesn't support
							cloning. This is the way mandated by the "Cloneable" contract and convention of the JDK.
							Setting this to "no" will throw a RuntimeException instead. Default: y

### Limitations
* There should be an option to create a copy constructor instead of a clone method.




